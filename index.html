<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>CA Solar PPA • Learn Mode</title>
  <meta name="theme-color" content="#0b1017"/>

  <style>
    :root{
      --navy:#0b1017;
      --navy2:#06122a;

      --gold:#FBC909;
      --teal:#3AADBB;
      --lime:#86f7a6;

      --text:rgba(255,255,255,.94);
      --muted:rgba(255,255,255,.70);
      --muted2:rgba(255,255,255,.56);

      --stroke: rgba(255,255,255,.10);
      --shadow: 0 18px 70px rgba(0,0,0,.45);

      --r:18px;
      --r2:28px;

      --safeT: env(safe-area-inset-top);
      --safeB: env(safe-area-inset-bottom);
      --safeL: env(safe-area-inset-left);
      --safeR: env(safe-area-inset-right);

      --grad: linear-gradient(135deg, rgba(251,201,9,.22), rgba(58,173,187,.18));
      --glass: rgba(15,23,36,.62);
      --glass2: rgba(0,0,0,.18);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background:
        radial-gradient(1100px 700px at 20% -10%, rgba(251,201,9,.18), transparent 60%),
        radial-gradient(900px 600px at 110% 10%, rgba(58,173,187,.18), transparent 55%),
        linear-gradient(180deg, var(--navy), var(--navy2));
      color: var(--text);
      padding: calc(14px + var(--safeT)) calc(14px + var(--safeR)) calc(16px + var(--safeB)) calc(14px + var(--safeL));
    }

    .wrap{ max-width: 980px; margin: 0 auto; }

    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding: 12px 12px;
      border:1px solid var(--stroke);
      border-radius: var(--r2);
      background: rgba(15,23,36,.55);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
    }
    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:0;
    }
    .logo{
      width:42px; height:42px;
      border-radius: 14px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.06);
      overflow:hidden;
      display:grid; place-items:center;
      flex:0 0 auto;
    }
    .logo img{ width:100%; height:100%; object-fit:cover; }
    .titleWrap{ min-width:0; }
    .appTitle{
      margin:0;
      font-size: 15px;
      letter-spacing: .2px;
      line-height: 1.15;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .appSub{
      margin: 5px 0 0 0;
      font-size: 12px;
      color: var(--muted);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .right{
      display:flex;
      align-items:center;
      gap:8px;
      flex:0 0 auto;
    }
    .pill{
      font-size:12px;
      padding: 8px 10px;
      border-radius: 999px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.06);
      color: var(--muted);
      white-space:nowrap;
    }
    .pill b{
      background: linear-gradient(135deg, var(--gold), var(--teal));
      -webkit-background-clip:text;
      background-clip:text;
      color: transparent;
    }
    .iconBtn{
      width:40px; height:40px;
      border-radius: 14px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.88);
      cursor:pointer;
      display:grid;
      place-items:center;
      user-select:none;
    }
    .iconBtn:active{ transform: scale(.98); }

    .stage{
      margin-top: 14px;
      border-radius: var(--r2);
      border:1px solid var(--stroke);
      background: rgba(15,23,36,.55);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }

    .card{
      min-height: calc(88vh - 70px);
      padding: 22px 18px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      gap: 18px;
      touch-action: pan-y;
      user-select:none;
    }

    .topRow{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      color: var(--muted);
      font-size: 13px;
    }
    .progress{
      display:flex;
      align-items:center;
      gap:8px;
      white-space:nowrap;
    }
    .dots{
      display:flex;
      gap:6px;
      align-items:center;
    }
    .dot{
      width:7px;height:7px;border-radius:999px;
      background: rgba(255,255,255,.18);
      border:1px solid rgba(255,255,255,.10);
    }
    .dot.on{
      background: rgba(251,201,9,.90);
      border-color: rgba(251,201,9,.35);
      box-shadow: 0 0 0 4px rgba(251,201,9,.12);
    }

    .qTitle{
      font-size: 26px;
      line-height: 1.25;
      text-align:center;
      margin: 0;
      letter-spacing: .2px;
      padding: 0 6px;
    }

    .say{
      border-radius: 24px;
      padding: 18px 16px;
      border:1px solid rgba(251,201,9,.22);
      background: linear-gradient(135deg, rgba(251,201,9,.22), rgba(251,201,9,.06));
    }
    .label{
      font-size: 12px;
      letter-spacing: .4px;
      text-transform: uppercase;
      color: rgba(255,255,255,.74);
      display:flex;
      align-items:center;
      gap:8px;
    }
    .label .chipDot{
      width:10px;height:10px;border-radius:999px;
      background: rgba(251,201,9,.95);
      box-shadow: 0 0 0 4px rgba(251,201,9,.12);
    }
    .say p{
      margin: 10px 0 0 0;
      font-size: 19px;
      line-height: 1.6;
      color: rgba(255,255,255,.94);
    }

    .actions{
      display:grid;
      gap: 10px;
    }
    .btn{
      width:100%;
      padding: 16px 14px;
      font-size: 17px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.92);
      cursor:pointer;
      text-align:left;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .btn:active{ transform: scale(.99); }
    .btn .hint{
      font-size: 13px;
      color: var(--muted2);
    }
    .btn.teal{
      border-color: rgba(58,173,187,.22);
      background: linear-gradient(135deg, rgba(58,173,187,.18), rgba(58,173,187,.06));
    }
    .btn.gray{
      background: rgba(0,0,0,.18);
    }

    .nav{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding-top: 6px;
    }
    .navBtn{
      flex:1;
      padding: 14px 12px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.90);
      cursor:pointer;
      font-size: 16px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      user-select:none;
    }
    .navBtn.primary{
      border-color: rgba(251,201,9,.22);
      background: var(--grad);
      color: rgba(255,255,255,.96);
      font-weight: 650;
    }
    .navBtn:disabled{
      opacity: .45;
      cursor:not-allowed;
    }

    .footerHint{
      text-align:center;
      color: var(--muted2);
      font-size: 12px;
      line-height: 1.35;
      padding: 10px 14px 14px 14px;
      border-top: 1px solid rgba(255,255,255,.08);
    }

    .animOutLeft{ animation: outLeft .18s ease both; }
    .animInRight{ animation: inRight .20s ease both; }
    .animOutRight{ animation: outRight .18s ease both; }
    .animInLeft{ animation: inLeft .20s ease both; }

    @keyframes outLeft{ to{ transform: translateX(-18px); opacity:.0; } }
    @keyframes inRight{ from{ transform: translateX(18px); opacity:.0; } to{ transform: translateX(0); opacity:1; } }
    @keyframes outRight{ to{ transform: translateX(18px); opacity:.0; } }
    @keyframes inLeft{ from{ transform: translateX(-18px); opacity:.0; } to{ transform: translateX(0); opacity:1; } }

    .sheetBack{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.45);
      display:none;
      align-items:flex-end;
      justify-content:center;
      padding: 14px;
      z-index:50;
    }
    .sheet{
      width: min(980px, 100%);
      border-radius: 26px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(15,23,36,.86);
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow);
      overflow:hidden;
      transform: translateY(12px);
      opacity: 0;
      transition: transform .18s ease, opacity .18s ease;
    }
    .sheetBack.show{ display:flex; }
    .sheetBack.show .sheet{
      transform: translateY(0);
      opacity: 1;
    }
    .sheetHead{
      padding: 14px 14px 10px 14px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      border-bottom:1px solid rgba(255,255,255,.10);
    }
    .sheetTitle{
      margin:0;
      font-size: 16px;
      letter-spacing:.2px;
    }
    .sheetClose{
      width:40px;height:40px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.92);
      cursor:pointer;
      display:grid; place-items:center;
      user-select:none;
      flex:0 0 auto;
    }
    .sheetBody{
      padding: 12px 14px 16px 14px;
      color: rgba(255,255,255,.86);
      line-height: 1.55;
      font-size: 16px;
    }
    .bullets{
      margin: 10px 0 0 0;
      padding-left: 18px;
      color: rgba(255,255,255,.84);
    }
    .bullets li{ margin: 8px 0; }
    .tagRow{
      padding: 10px 14px 14px 14px;
      border-top: 1px solid rgba(255,255,255,.10);
      color: var(--muted2);
      font-size: 12px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }

    .kbd{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      min-width: 22px;
      padding: 2px 7px;
      border-radius: 10px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.20);
      color: rgba(255,255,255,.72);
      font-size: 12px;
    }
  </style>
</head>

<body>
<div class="wrap">

  <header>
    <div class="brand">
      <div class="logo" title="L.O.S.">
        <img src="los-logo.png" alt="LOS Logo"
          onerror="this.style.display='none'; this.parentElement.textContent='LOS'; this.parentElement.style.fontWeight='800'; this.parentElement.style.color='rgba(255,255,255,.9)';">
      </div>
      <div class="titleWrap">
        <p class="appTitle">CA Solar PPA • Learn Mode</p>
        <p class="appSub">Swipe to learn • Tap to reveal why/verify</p>
      </div>
    </div>

    <div class="right">
      <div class="pill"><b>Apple</b> style</div>
      <button class="iconBtn" id="helpBtn" title="Help">?</button>
    </div>
  </header>

  <section class="stage">
    <div class="card" id="card"></div>
    <div class="footerHint">
      Swipe <span class="kbd">←</span> <span class="kbd">→</span> to move • Tap “Why this works” + “Verify in contract” when needed.
    </div>
  </section>
</div>

<!-- Bottom Sheet -->
<div class="sheetBack" id="sheetBack" aria-hidden="true">
  <div class="sheet" role="dialog" aria-modal="true">
    <div class="sheetHead">
      <div>
        <h3 class="sheetTitle" id="sheetTitle">Title</h3>
        <div style="margin-top:6px;color:var(--muted);font-size:12px" id="sheetSub"></div>
      </div>
      <button class="sheetClose" id="sheetClose" aria-label="Close">✕</button>
    </div>
    <div class="sheetBody" id="sheetBody"></div>
    <div class="tagRow" id="sheetTagRow">
      <span id="sheetTagLeft"></span>
      <span id="sheetTagRight"></span>
    </div>
  </div>
</div>

<script>
/* =========================
   Customer-Concern Learn Deck
   ========================= */
const DECK = [
  {
    tag: "Start Here",
    q: "Is this a loan? Am I buying the panels?",
    say: "No loan.\nWith a PPA, you buy the power the system produces.\nThe provider owns the equipment.",
    why: "This removes the #1 fear (hidden loan / ownership confusion) and builds instant trust.",
    verify: [
      "Ownership language (provider owns system)",
      "You pay per kWh produced (not a loan payment)",
      "Term length + billing method"
    ]
  },
  {
    tag: "Price",
    q: "What am I paying for—panels or electricity?",
    say: "You’re paying for electricity (kWh) the system makes.\nNot the panels themselves.",
    why: "If they think they’re “financing panels,” everything else sounds like a scam. Keep it simple.",
    verify: [
      "PPA rate expressed as $/kWh",
      "How production is measured (monitoring/metering)",
      "Any minimum payment clause"
    ]
  },
  {
    tag: "Bills",
    q: "Do I still get an Edison bill?",
    say: "Yes—most homes still have a small utility bill.\nSolar reduces what you buy from Edison.",
    why: "If you promise “no utility bill,” you create disappointment and chargeback risk.",
    verify: [
      "Utility charges that remain (minimum charges, etc.)",
      "How credits are handled (if applicable)",
      "System size vs usage assumptions"
    ]
  },
  {
    tag: "Savings",
    q: "How do I know I’m actually saving money?",
    say: "We compare your current cost per kWh to the solar kWh price.\nIf solar is lower—and sized right—you save.",
    why: "Monthly totals confuse people. kWh price is the cleanest apples-to-apples comparison.",
    verify: [
      "Starting solar kWh price",
      "Escalator (0% or %/yr) details",
      "Estimated annual production vs annual usage"
    ]
  },
  {
    tag: "Escalator",
    q: "What is an escalator—and why would I choose 0%?",
    say: "An escalator is the yearly increase on the solar kWh price.\n0% costs more today but stays flatter long-term.",
    why: "This is the biggest long-term money lever. Clarity prevents future regret and cancellations.",
    verify: [
      "Exact escalator % and start date",
      "Whether it applies to all kWh",
      "Any caps or special terms"
    ]
  },
  {
    tag: "Trust",
    q: "Is this ‘free solar’ or ‘government program’?",
    say: "No.\nThis is a private agreement with a solar company.\nWe review every term in writing.",
    why: "Homeowners have heard scams. Being direct makes you the safe option.",
    verify: [
      "Company name matches contract paperwork",
      "All pricing terms written (rate + escalator)",
      "Any fees/penalties disclosed in writing"
    ]
  },
  {
    tag: "Contract",
    q: "How long am I locked in?",
    say: "Most PPAs are long-term.\nWe’ll show the exact term and the options you have later.",
    why: "People fear being trapped. You lower anxiety by pointing to clear options.",
    verify: [
      "Term length",
      "Renewal language",
      "End-of-term options (renew/buy/remove)"
    ]
  },
  {
    tag: "Buyout",
    q: "Can I buy it out later? How does that work?",
    say: "Often yes.\nSome contracts allow a buyout at specific years.\nWe’ll show the buyout rules in writing.",
    why: "Buyout clarity gives control, especially for homeowners who may refinance or sell later.",
    verify: [
      "Buyout windows (when allowed)",
      "Price method (schedule vs fair market value)",
      "Admin/transaction fees (if any)"
    ]
  },
  {
    tag: "Home Sale",
    q: "What if I sell my home—will this mess up escrow?",
    say: "Usually it transfers to the buyer,\nor you may buy it out—depending on the contract.\nWe’ll walk the exact steps.",
    why: "This is a top concern. Reassure with process: transfer OR buyout, not mystery.",
    verify: [
      "Transfer requirements + buyer approval",
      "Transfer timeline + fees",
      "What happens if buyer declines"
    ]
  },
  {
    tag: "Roof",
    q: "What if my roof leaks or needs replacement?",
    say: "Roof issues are usually homeowner responsibility.\nIf panels must be removed/reinstalled, the contract says who pays and how.",
    why: "Roof questions are a trust test. If you’re vague, they assume hidden costs.",
    verify: [
      "Remove/reinstall responsibility + pricing",
      "Roof leak responsibility language",
      "Service request process + timing"
    ]
  },
  {
    tag: "Maintenance",
    q: "If something breaks, who fixes it and who pays?",
    say: "Typically the provider monitors and repairs the system.\nWe’ll confirm what’s covered and what’s excluded.",
    why: "This is a core PPA advantage—less homeowner responsibility—IF explained clearly.",
    verify: [
      "Monitoring included",
      "Repair coverage + exclusions",
      "How to request service"
    ]
  },
  {
    tag: "Insurance",
    q: "Do I need different homeowner’s insurance?",
    say: "Sometimes the provider covers the equipment.\nWe’ll confirm if your policy needs any updates.",
    why: "People worry about surprise insurance requirements. Calm, contract-based answer wins.",
    verify: [
      "Insurance responsibility section",
      "Damage responsibility (weather, accidents)",
      "Any homeowner obligations"
    ]
  },
  {
    tag: "Fees",
    q: "Are there hidden fees or penalties?",
    say: "We’ll review fees in writing.\nMost concerns are transfer fees, late fees, or early termination terms.",
    why: "If you bring this up first, you look honest and eliminate the “gotcha” fear.",
    verify: [
      "All fees/penalties section",
      "Transfer fees (if any)",
      "Early termination language"
    ]
  },
  {
    tag: "NEM 3.0",
    q: "Why do batteries come up so much now?",
    say: "Extra solar sent to the grid is worth less than it used to be.\nBatteries help you use more solar during expensive hours.",
    why: "This answers ‘why battery?’ in one clean concept: control expensive time.",
    verify: [
      "Battery included or optional",
      "Backup vs self-consumption settings",
      "Battery warranty/coverage terms"
    ]
  },
  {
    tag: "Outages",
    q: "If the power goes out, will solar still work?",
    say: "Most grid-tied solar shuts off during outages for safety.\nWith a battery and proper setup, selected circuits can stay on.",
    why: "This prevents the biggest outage misconception and builds credibility.",
    verify: [
      "Backup equipment included",
      "Which circuits/loads are backed up",
      "Any backup subpanel scope"
    ]
  },
  {
    tag: "Performance",
    q: "What if the system doesn’t produce what you projected?",
    say: "We’ll review what the contract says about under-production.\nNever rely on verbal promises—only written terms.",
    why: "Production concerns drive cancellations. Contract-first language protects everyone.",
    verify: [
      "Any production guarantee/remedy language",
      "How production is measured and over what timeframe",
      "Exclusions (shade growth, weather, etc.)"
    ]
  },
  {
    tag: "Trust",
    q: "How do I know this company is legit?",
    say: "We verify licensing and who is responsible for install and service.\nAnd we make sure the contract matches what we discussed.",
    why: "Homeowners have seen shady reps. Verification turns you into the safe guide.",
    verify: [
      "Installer/contractor identity + license info",
      "Who services the system (provider vs subcontractor)",
      "Paperwork names match your proposal"
    ]
  },
  {
    tag: "Decision",
    q: "What’s the simplest way to decide if this is right?",
    say: "If it lowers your cost per kWh today,\nkeeps terms clear for the future,\nand fits your home plans—then it makes sense.",
    why: "People need a calm framework. This reduces pressure and increases close rate.",
    verify: [
      "Day-one savings expectation",
      "Escalator choice",
      "Home sale plan (transfer vs buyout)"
    ]
  }
];

/* =========================
   Render
   ========================= */
const cardEl = document.getElementById("card");
let idx = 0;

function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

function render(animInClass){
  const item = DECK[idx];
  const total = DECK.length;

  const dots = Array.from({length: Math.min(total, 10)}, (_,i)=>i)
    .map(i=>{
      let base = 0;
      if(total > 10){
        base = clamp(idx - 4, 0, total - 10);
      }
      const real = (total > 10) ? (base + i) : i;
      const on = (real === idx) ? "on" : "";
      return `<span class="dot ${on}"></span>`;
    }).join("");

  const html = `
    <div class="topRow">
      <div class="progress">
        <span><b style="color:rgba(255,255,255,.92)">Question ${idx+1}</b> of ${total}</span>
        <span style="opacity:.65">•</span>
        <span style="color:rgba(251,201,9,.92)">${escapeHtml(item.tag)}</span>
      </div>
      <div class="dots" aria-hidden="true">${dots}</div>
    </div>

    <h1 class="qTitle">${escapeHtml(item.q)}</h1>

    <div class="say">
      <div class="label"><span class="chipDot"></span> Say this</div>
      <p>${escapeHtml(item.say).replace(/\n/g,"<br>")}</p>
    </div>

    <div class="actions">
      <button class="btn teal" id="whyBtn">
        <span>Why this works</span>
        <span class="hint">tap ▸</span>
      </button>
      <button class="btn gray" id="verifyBtn">
        <span>Verify in contract</span>
        <span class="hint">tap ▸</span>
      </button>
    </div>

    <div class="nav">
      <button class="navBtn" id="backBtn" ${idx===0 ? "disabled" : ""}>◀ Back</button>
      <button class="navBtn primary" id="nextBtn" ${idx===total-1 ? "disabled" : ""}>Next ▶</button>
    </div>
  `;

  cardEl.className = "card";
  if(animInClass) cardEl.classList.add(animInClass);
  cardEl.innerHTML = html;

  document.getElementById("whyBtn").onclick = ()=> openSheet("Why this works", item.why, item);
  document.getElementById("verifyBtn").onclick = ()=> openSheet("Verify in contract", item.verify, item, true);

  document.getElementById("backBtn").onclick = ()=> go(-1);
  document.getElementById("nextBtn").onclick = ()=> go(1);
}

function go(delta){
  const total = DECK.length;
  const next = idx + delta;
  if(next < 0 || next >= total) return;

  const outClass = delta > 0 ? "animOutLeft" : "animOutRight";
  const inClass  = delta > 0 ? "animInRight" : "animInLeft";

  cardEl.classList.remove("animInRight","animInLeft","animOutLeft","animOutRight");
  cardEl.classList.add(outClass);

  setTimeout(()=>{
    idx = next;
    render(inClass);
  }, 165);
}

/* =========================
   Swipe
   ========================= */
let startX = 0, startY = 0, dragging = false;

cardEl.addEventListener("pointerdown", (e)=>{
  if(document.getElementById("sheetBack").classList.contains("show")) return;
  dragging = true;
  startX = e.clientX;
  startY = e.clientY;
});

cardEl.addEventListener("pointerup", (e)=>{
  if(!dragging) return;
  dragging = false;
  const dx = e.clientX - startX;
  const dy = e.clientY - startY;

  if(Math.abs(dx) > 55 && Math.abs(dx) > Math.abs(dy) * 1.2){
    if(dx < 0) go(1);
    else go(-1);
  }
});

/* =========================
   Bottom Sheet
   ========================= */
const sheetBack = document.getElementById("sheetBack");
const sheetTitle = document.getElementById("sheetTitle");
const sheetSub = document.getElementById("sheetSub");
const sheetBody = document.getElementById("sheetBody");
const sheetClose = document.getElementById("sheetClose");
const sheetTagLeft = document.getElementById("sheetTagLeft");
const sheetTagRight = document.getElementById("sheetTagRight");

function openSheet(title, content, item, isBullets=false){
  sheetTitle.textContent = title;
  sheetSub.textContent = item.q || "";

  if(isBullets){
    sheetBody.innerHTML = `
      <ul class="bullets">
        ${(content || []).map(x=> `<li>${escapeHtml(x)}</li>`).join("")}
      </ul>
    `;
  } else {
    sheetBody.innerHTML = `<div>${escapeHtml(content || "")}</div>`;
  }

  sheetTagLeft.textContent = item.tag ? `Category: ${item.tag}` : "";
  sheetTagRight.textContent = `Swipe: next/prev`;

  sheetBack.classList.add("show");
  sheetBack.setAttribute("aria-hidden","false");
}

function closeSheet(){
  sheetBack.classList.remove("show");
  sheetBack.setAttribute("aria-hidden","true");
}

sheetClose.onclick = closeSheet;
sheetBack.addEventListener("click", (e)=>{
  if(e.target === sheetBack) closeSheet();
});
window.addEventListener("keydown", (e)=>{
  if(e.key === "Escape") closeSheet();
  if(sheetBack.classList.contains("show")) return;
  if(e.key === "ArrowRight") go(1);
  if(e.key === "ArrowLeft") go(-1);
});

/* =========================
   Help
   ========================= */
document.getElementById("helpBtn").onclick = ()=>{
  openSheet(
    "How to use Learn Mode",
    "Use this like iPhone onboarding:\n\n• Read the “Say this” out loud.\n• Tap “Why” only if you need the reason.\n• Tap “Verify” only when reviewing the contract.\n\nSwipe left/right to move.\n\nPro tip: Run the deck twice before the sit.",
    { q:"", tag:"Help" }
  );
};

/* =========================
   Utils
   ========================= */
function escapeHtml(str){
  return String(str ?? "")
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#039;");
}

/* Init */
render();
</script>
</body>
</html>
